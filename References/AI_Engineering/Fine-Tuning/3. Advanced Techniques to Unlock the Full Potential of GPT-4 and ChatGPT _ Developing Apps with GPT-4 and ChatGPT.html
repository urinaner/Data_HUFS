<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 23.7.0" /><title>3. Advanced Techniques to Unlock the Full Potential of GPT-4 and ChatGPT | Developing Apps with GPT-4 and ChatGPT</title><style type="text/css">body { font-family:'Times New Roman'; font-size:12pt }h1, h2, h3, h4, h5, h6, p { margin:0pt }h1 { margin-top:12pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; font-family:Calibri; font-size:24pt; font-weight:bold; font-style:normal; color:#2f5496 }h2 { margin-top:2pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; font-family:Calibri; font-size:18pt; font-weight:bold; font-style:normal; color:#2f5496 }h3 { margin-top:2pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; font-family:Calibri; font-size:14pt; font-weight:bold; font-style:normal; color:#1f3763 }h4 { margin-top:2pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; font-family:Calibri; font-size:12pt; font-weight:bold; font-style:normal; color:#2f5496 }h5 { margin-top:2pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; font-family:Calibri; font-size:10pt; font-weight:bold; font-style:normal; color:#2f5496 }h6 { margin-top:2pt; margin-bottom:0pt; page-break-inside:avoid; page-break-after:avoid; font-family:Calibri; font-size:8pt; font-weight:bold; font-style:normal; color:#1f3763 }.annotatable--okKet { font-size:12pt }.any { font-size:12pt }.book-content { font-family:'Times New Roman'; font-size:12pt }.book-contentsbo-rt-contentdiv { line-height:18pt; font-size:12pt }.book-contentsbo-rt-contentdivdata-typenote { border-top:0.75pt solid #8b889a; border-bottom:0.75pt solid #8b889a; font-size:12pt }.book-contentsbo-rt-contentdivdata-typenoteh6 { text-align:left; line-height:8.25pt; font-family:Arial; font-size:8.5pt; font-weight:bold; text-transform:uppercase; color:#018c8c }.book-contentsbo-rt-contentdivdata-typewarning { border-top:0.75pt solid #8b889a; border-bottom:0.75pt solid #8b889a; font-size:12pt }.book-contentsbo-rt-contentdivdata-typewarningh6 { text-align:left; line-height:8.25pt; font-family:Arial; font-size:8.5pt; font-weight:bold; text-transform:uppercase; color:#aa8f00 }.book-contentsbo-rt-contentdivsidebar { border-top:0.75pt solid #8b889a; border-bottom:0.75pt solid #8b889a; font-size:12pt }.book-contentsbo-rt-contentdivsidebarh1 { text-align:left; line-height:8.25pt; font-family:Arial; font-size:8.5pt; font-weight:bold; text-transform:uppercase; color:#018c8c }.book-contentsbo-rt-contentfigure { line-height:18pt; font-size:12pt }.book-contentsbo-rt-contentfigureh6 { line-height:10.1pt; font-family:'Times New Roman'; font-size:9pt; font-weight:normal }.book-contentsbo-rt-contentfigurep { line-height:10.1pt; font-family:'Times New Roman'; font-size:9pt; font-weight:normal }.book-contentsbo-rt-contenth1 { text-align:left; line-height:33.75pt; font-family:'Times New Roman'; font-size:22.5pt; font-weight:normal; font-style:normal; color:#3d3b49 }.book-contentsbo-rt-contenth2 { line-height:24.75pt; font-family:'Times New Roman'; font-size:16.5pt; font-weight:bold; font-style:normal; color:#3d3b49 }.book-contentsbo-rt-contenth3 { line-height:20.25pt; font-family:'Times New Roman'; font-size:13.5pt; font-weight:bold; font-style:normal; color:#3d3b49 }.book-contentsbo-rt-contenth4 { line-height:18pt; font-family:'Times New Roman'; font-size:12pt; font-weight:bold; font-style:normal; color:#3d3b49 }.book-contentsbo-rt-contentp { text-align:left; line-height:21pt; font-family:'Times New Roman'; font-size:12pt; font-weight:normal }.book-contentsbo-rt-contentpre { line-height:18pt; font-family:Consolas; font-size:12pt; color:#3d3b49; background-color:#eef2f6 }.css-1f1pypa { border:0.75pt solid #0071eb; padding:12pt 18pt; font-size:12pt; background-color:#ffffff }.css-1kokv6u { font-size:12pt; background-color:#cacbd6 }.css-1komcmk { font-size:12pt }.css-1komcmkMuiDrawer-paper { font-size:12pt }.css-1t01ifk { text-align:left; font-size:12pt; color:#302f2a }.css-5aqo4x { text-align:left; font-size:12pt }.css-8lnklk { font-size:12pt }.css-919eu4 { font-size:12pt }.css-csz18i { font-size:12pt }.css-my8xu5 { font-size:12pt; background-color:#ffffff }.css-zxyyug { font-size:12pt }.currentTitle--zObOd { font-size:12pt }.icon--oixR1 { font-size:12pt }.navContainer--DXAXa { font-size:12pt }.nextContainer--DE38N { font-size:12pt }.onetrust-consent-sdkonetrust-pc-sdk { font-size:12pt; background-color:#ffffff }.onetrust-consent-sdkonetrust-pc-sdkh3 { font-size:12pt; color:#515151 }.onetrust-consent-sdkonetrust-pc-sdkot-acc-grpcntrot-acc-txt { font-size:12pt; background-color:#f8f8f8 }.onetrust-consent-sdkonetrust-pc-sdkot-anchor { font-size:12pt; background-color:#ffffff }.onetrust-consent-sdkonetrust-pc-sdkot-fltr-cnt { font-size:12pt; background-color:#ffffff }.onetrust-consent-sdkonetrust-pc-sdkot-pc-desc { font-size:12pt; color:#515151 }.onetrust-consent-sdkonetrust-pc-sdkot-pc-title { font-size:12pt; color:#515151 }.onetrust-consent-sdkonetrust-pc-sdkp { font-size:12pt; color:#515151 }.onetrust-consent-sdkonetrust-pc-sdkprivacy-notice-link { font-size:12pt; color:#0345ff }.onetrust-pc-dark-filterot-fade-in { font-size:12pt }.onetrust-pc-sdkdiv { text-indent:0pt; text-align:left; font-size:12pt; font-weight:normal; text-transform:none; letter-spacing:0pt; vertical-align:baseline }.onetrust-pc-sdkot-accordion-layouth4ot-always-active { font-size:12pt }.onetrust-pc-sdkot-accordion-layoutot-cat-item { border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; font-size:12pt }.onetrust-pc-sdkot-accordion-layoutot-cat-itemnth-of-type1 { border-top:0.75pt solid #d8d8d8; font-size:12pt }.onetrust-pc-sdkot-btn-container { text-align:left; font-size:12pt }.onetrust-pc-sdkot-chkbox { font-size:12pt }.onetrust-pc-sdkot-fltr-btns { font-size:12pt }.onetrust-pc-sdkot-fltr-cntr { font-size:12pt }.onetrust-pc-sdkot-fltr-opt { font-size:12pt }.onetrust-pc-sdkot-lst-title { font-size:12pt; font-weight:bold }.onetrust-pc-sdkot-pc-content { text-indent:0pt; text-align:left; font-size:12pt; font-weight:normal; text-transform:none; letter-spacing:0pt; vertical-align:baseline }.onetrust-pc-sdkot-pc-footer { border-top:0.75pt solid #d8d8d8; font-size:12pt }.onetrust-pc-sdkot-pc-footer-logo { text-align:right; font-size:12pt; background-color:#f4f4f4 }.onetrust-pc-sdkot-pc-header { border-bottom:0.75pt solid #e9e9e9; padding-bottom:7pt; font-size:12pt }.onetrust-pc-sdkot-pc-scrollbar { font-size:12pt }.onetrust-pc-sdkot-sdk-row { font-size:12pt }.onetrust-pc-sdkot-search-cntr { font-size:12pt }.onetrust-pc-sdkot-sel-all { font-size:12pt }.onetrust-pc-sdkot-sel-blkot-chkbox { font-size:12pt }.orm-ProgressBar-labels { line-height:11.95pt; font-size:9pt }.orm-ProgressBar-labels-afterorm-ProgressBar-bar { font-size:12pt }.orm-ProgressBar-progress { font-size:12pt }.orm-ProgressBar-root { font-size:12pt }.playlistsDropdown--FC2Kf { font-size:12pt }.prevContainer--NNo8v { font-size:12pt }.readerContainer--bZ89H { font-size:12pt }.tooltip--s45LA { line-height:12pt; font-size:10.5pt; font-weight:bold }span.Heading1Char { font-family:'Calibri Light'; font-size:16pt; color:#2f5496 }span.Heading2Char { font-family:'Calibri Light'; font-size:13pt; color:#2f5496 }span.Heading3Char { font-family:'Calibri Light'; font-size:12pt; color:#1f3763 }span.Heading4Char { font-family:'Calibri Light'; font-style:italic; color:#2f5496 }span.Heading5Char { font-family:'Calibri Light'; color:#2f5496 }span.Heading6Char { font-family:'Calibri Light'; color:#1f3763 }span.book-contentsbo-rt-contentalink { font-family:'Times New Roman'; color:#d3002d }span.book-contentsbo-rt-contentcode { font-family:Consolas; font-size:12pt; font-weight:normal; background-color:#eef2f6 }span.book-contentsbo-rt-contentem { font-style:italic }span.book-contentsbo-rt-contentstrong { font-weight:bold; font-style:normal }span.css-16u51uz { font-size:12pt; color:#0054b5; background-color:#ffffff }span.css-188plk9 { border:0.75pt solid #ffffff; font-family:Gilroy; font-size:12pt; font-weight:bold; text-transform:none; letter-spacing:0.05pt }span.css-192odnt { font-size:20.5pt }span.css-52we4o { font-size:20.5pt }span.css-ym2bkf { font-size:20.5pt; background-color:#ffffff }span.onetrust-consent-sdkonetrust-pc-sdkbuttonnotclear-filters-handlernotot-close-iconnotfilter-btn-handlernotot-remove-objection-handlernotot-obj-leg-btn-handlernotaria-expandednotot-link-btn { color:#ffffff; background-color:#0345ff }span.onetrust-consent-sdkonetrust-pc-sdkclear-filters-handler { color:#515151 }span.onetrust-consent-sdkonetrust-pc-sdkh4 { color:#515151 }span.onetrust-consent-sdkonetrust-pc-sdkot-chkboxlabelspan { color:#515151 }span.onetrust-consent-sdkonetrust-pc-sdkot-label-status { color:#515151 }span.onetrust-consent-sdkonetrust-pc-sdkot-pc-lstot-lst-titlespan { color:#515151 }span.onetrust-consent-sdkonetrust-pc-sdkot-sel-all-hdrspan { color:#515151 }span.onetrust-consent-sdkonetrust-pc-sdkot-sel-blk { background-color:#ffffff }span.onetrust-pc-sdkfilter-btn-handler { background-color:#3860be }span.onetrust-pc-sdkot-fltr-modal { display:none }span.onetrust-pc-sdkot-link-btn { font-weight:normal }span.onetrust-pc-sdkot-plus-minus { font-size:18pt }span.orm-Icon-icon { font-family:'ORM Icons'; font-weight:normal; font-style:normal; font-variant:normal; text-transform:none }span.sbo-rt-contentspan { vertical-align:baseline }span.title--kaGlz { display:none }</style></head><body><div><p class="css-1f1pypa"><a href="https://learning.oreilly.com/library/view/developing-apps-with/9781098152475/ch03.html#main" style="text-decoration:none"><span style="text-decoration:underline">Skip to Content</span></a></p><p class="css-my8xu5" style="padding-right:18pt; padding-left:18pt; font-size:20.5pt"><span style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline"><svg fill="none" height="16" stroke="#302F2A" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg" style="width:16px; height:16px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:none; stroke:#302f2a"><path d="M1 3H15M1 8H15M1 13H15" stroke-linecap="round" stroke-width="2" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:none; stroke:#302f2a; stroke-linecap:round; stroke-width:2" /></svg></span><a href="https://learning.oreilly.com/home/" style="text-decoration:none"><span style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline"><svg class="css-pylinu" fill="none" height="18.66" viewBox="0 0 91 18" width="91.99" xmlns="http://www.w3.org/2000/svg" style="width:91.99px; height:18.66px; text-align:center; border-top-color:#0000ee; border-right-color:#0000ee; border-left-color:#0000ee; border-bottom-color:#0000ee; font-family:Gilroy; font-size:20.57pt; color:#0000ee; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:#d30000"><path clip-rule="evenodd" d="M18.175 4.66871C19.25 4.66871 20.125 3.78409 20.125 2.69727C20.125 1.61045 19.275 0.751105 18.175 0.72583C17.1 0.72583 16.225 1.61045 16.225 2.69727C16.225 3.78409 17.1 4.66871 18.175 4.66871ZM2.625 9.0918C2.625 7.52476 3.25 6.10936 4.275 5.0731C5.3 4.03683 6.675 3.40496 8.225 3.40496C9.775 3.40496 11.175 4.03683 12.2 5.0731C13.225 6.10936 13.85 7.52476 13.85 9.0918C13.85 10.6588 13.225 12.049 12.225 13.1105C11.2 14.1468 9.8 14.7786 8.25 14.7786C6.7 14.7786 5.3 14.1468 4.275 13.1105C3.25 12.0742 2.625 10.6588 2.625 9.0918ZM8.25 0.751097C3.7 0.751097 0 4.49177 0 9.0918C0 13.6918 3.675 17.4072 8.25 17.4325C12.8 17.4325 16.5 13.6918 16.5 9.0918C16.5 4.49177 12.8 0.751097 8.25 0.751097ZM24.65 7.64733V3.6539H29.975C31.075 3.6539 31.95 4.53852 31.95 5.65062C31.95 6.76271 31.075 7.64733 29.975 7.64733H24.65ZM31.275 10.1495C33.175 9.56822 34.575 7.79898 34.575 5.67589C34.575 3.09785 32.5 1.00004 29.95 1.00004H22V16.999H24.65V10.3265H28.325L32.3 16.999H35.375L31.275 10.1495ZM48.25 1.00004V3.6539H39.875V7.6726H47.825V10.3265H39.875V14.3452H48.25V16.999H37.225V1.00004H48.25ZM53.65 1.00004H51V16.999H53.65V1.00004ZM56.4 1.00004V16.999H66.675V14.3452H59.05V1.00004H56.4ZM68.825 16.999V1.00004H71.45V14.3452H79.075V16.999H68.825ZM87.625 1.00004H90.825L84.875 9.71987V16.999H82.25V9.69459L76.3 1.00004H79.5L83.575 6.93963L87.625 1.00004Z" fill="#D3002D" fill-rule="evenodd" style="text-align:center; border-top-color:#0000ee; border-right-color:#0000ee; border-left-color:#0000ee; border-bottom-color:#0000ee; font-family:Gilroy; font-size:20.57pt; color:#0000ee; -webkit-print-color-adjust:exact; box-sizing:border-box; clip-rule:evenodd; fill:#d3002d; fill-rule:evenodd" /></svg></span></a><span style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline"><svg fill="#302f2a" height="20" viewBox="0 0 12 12" width="20" xmlns="http://www.w3.org/2000/svg" style="width:20px; height:20px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:#302f2a"><path clip-rule="evenodd" d="M6.94375 8.27927C6.24005 8.73524 5.40094 9 4.5 9C2.01472 9 0 6.98528 0 4.5C0 2.01472 2.01472 0 4.5 0C6.98528 0 9 2.01472 9 4.5C9 5.40094 8.73524 6.24005 8.27927 6.94375L12 10.6645L10.6645 12L6.94375 8.27927ZM4.5 7C5.88071 7 7 5.88071 7 4.5C7 3.11929 5.88071 2 4.5 2C3.11929 2 2 3.11929 2 4.5C2 5.88071 3.11929 7 4.5 7Z" fill-rule="evenodd" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; clip-rule:evenodd; fill:#302f2a; fill-rule:evenodd" /></svg></span></p><p class="any" style="margin-right:18pt; margin-left:18pt; background-color:#ffffff"><span class="css-188plk9">Topics</span></p><p class="any" style="margin-right:18pt; margin-left:18pt; background-color:#ffffff"><span class="css-188plk9">Start Learning</span></p><p class="css-zxyyug" style="margin-right:18pt; margin-left:18pt; background-color:#ffffff"><span style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline"><svg aria-hidden="true" class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-h8rt75" fill="none" focusable="false" height="16" viewBox="0 0 12 12" width="16" style="width:16px; height:16px; font-family:Gilroy; font-size:16px; display:inline-block; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:currentcolor; flex-shrink:0; user-select:none"><path clip-rule="evenodd" d="M10.6645 12L6.2575 7.59302L7.59302 6.2575L12 10.6645L10.6645 12Z" fill="#54595E" fill-rule="evenodd" style="font-family:Gilroy; font-size:16px; -webkit-print-color-adjust:exact; box-sizing:border-box; clip-rule:evenodd; fill:#54595e; fill-rule:evenodd" /><path clip-rule="evenodd" d="M4.5 9C6.98528 9 9 6.98528 9 4.5C9 2.01472 6.98528 0 4.5 0C2.01472 0 0 2.01472 0 4.5C0 6.98528 2.01472 9 4.5 9ZM7 4.5C7 5.88071 5.88071 7 4.5 7C3.11929 7 2 5.88071 2 4.5C2 3.11929 3.11929 2 4.5 2C5.88071 2 7 3.11929 7 4.5Z" fill="#54595E" fill-rule="evenodd" style="font-family:Gilroy; font-size:16px; -webkit-print-color-adjust:exact; box-sizing:border-box; clip-rule:evenodd; fill:#54595e; fill-rule:evenodd" /></svg></span></p><p style="margin-right:18pt; margin-left:18pt; line-height:12pt; background-color:#ffffff"><input type="text" name="" value="" /></p><p class="any" style="margin-right:18pt; margin-left:18pt; background-color:#ffffff"><span class="css-188plk9">What's New</span></p><p class="any" style="margin-right:18pt; margin-left:18pt; background-color:#ffffff"><span style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline"><svg class="avatarSvg" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg" style="width:24px; height:24px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box"><g clip-path="url(#circleClipPath)" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; clip-path:url('#circleClipPath')"><rect class="avatarBg" height="24" rx="12" width="24" style="width:24px; height:24px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:none" /><mask height="20" id="circleMask" maskUnits="userSpaceOnUse" width="20" x="2" y="2" style="width:20px; height:20px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; mask-type:alpha"><circle class="avatarCircle" cx="12" cy="12" r="10" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:#f3f2f5" /></mask><g mask="url(#circleMask)" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; mask:url('#circleMask')"><rect class="avatarRectangle" height="9" rx="4" width="8" x="8" y="5" style="width:8px; height:9px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:#302f2a" /><path class="avatarPath" clip-rule="evenodd" d="M8.46493 15.3486C4.40509 16.1779 1.5 18.3952 1.5 21.0001C1.5 24.3138 6.20101 27.0001 12 27.0001C17.799 27.0001 22.5 24.3138 22.5 21.0001C22.5 18.3952 19.5949 16.1779 15.5351 15.3486C14.5436 16.0727 13.3217 16.5001 12 16.5001C10.6783 16.5001 9.45637 16.0727 8.46493 15.3486Z" fill-rule="evenodd" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; clip-rule:evenodd; fill:#302f2a; fill-rule:evenodd" /></g></g><defs style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box"><linearGradient gradientUnits="userSpaceOnUse" id="rectangleGradient" x1="19.5" x2="10.0932" y1="14.1909" y2="7.27086" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box"><stop stop-color="#0071eb" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; stop-color:#0071eb" /><stop offset="1" stop-color="#6f1385" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; stop-color:#6f1385" /></linearGradient><linearGradient gradientUnits="userSpaceOnUse" id="pathGradient" x1="18" x2="10.9354" y1="22.0001" y2="10.3092" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box"><stop stop-color="#0071eb" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; stop-color:#0071eb" /><stop offset="1" stop-color="#6f1385" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; stop-color:#6f1385" /></linearGradient><linearGradient gradientUnits="userSpaceOnUse" id="circleGradient" x1="4.94658" x2="19.0534" y1="2.2918" y2="21.7082" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box"><stop stop-color="#0071eb" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; stop-color:#0071eb" /><stop offset="1" stop-color="#6f1385" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; stop-color:#6f1385" /></linearGradient><clipPath id="circleClipPath" style="text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box"><rect fill="white" height="24" rx="12" width="24" style="width:24px; height:24px; text-align:center; line-height:1.15; font-family:Gilroy; font-size:20.57pt; text-transform:none; -webkit-print-color-adjust:exact; box-sizing:border-box; fill:#ffffff" /></clipPath></defs></svg></span></p><p class="prevContainer--NNo8v" style="margin-right:30pt; margin-left:30pt; font-size:10.5pt"><a href="https://learning.oreilly.com/library/view/developing-apps-with/9781098152475/ch02.html" style="text-decoration:none"><span style="width:6pt; font-weight:bold; color:#000000; display:inline-block">&#xa0;</span><span class="prevContainer--NNo8va" style="font-weight:bold"> </span><span class="title--kaGlz" style="font-weight:bold">2. Taking a Deep Dive into the GPT-4 and ChatGPT APIs</span></a></p><p class="currentTitle--zObOd" style="margin-right:30pt; margin-left:30pt; padding-right:24pt; padding-left:24pt; font-size:10.5pt"><span class="css-zv7ju9" style="font-weight:bold">3. Advanced Techniques to Unlock the Full Potential of GPT-4 and ChatGPT</span></p><p class="nextContainer--DE38N" style="margin-right:30pt; margin-left:30pt; font-size:10.5pt"><a href="https://learning.oreilly.com/library/view/developing-apps-with/9781098152475/colophon01.html" style="text-decoration:none"><span class="title--kaGlz" style="font-weight:bold">About the Authors</span><span class="nextContainer--DE38Na" style="font-weight:bold"> </span><span style="width:27.36pt; font-weight:bold; color:#000000; display:inline-block">&#xa0;</span></a></p><p class="orm-ProgressBar-labels" style="margin:6pt 30pt"><span class="css-zv7ju9">39m remaining</span></p><p class="book-contentsbo-rt-contenth1" style="margin:15pt 30pt 24pt; background-color:#ffffff"><span class="sbo-rt-contentspanlabel">Chapter 3. </span><span class="css-zv7ju9">Advanced Techniques to Unlock the Full Potential of GPT-4 and ChatGPT</span></p><p class="book-contentsbo-rt-contentdivsidebarh1" style="margin:40.5pt 30pt 5.25pt; line-height:8.5pt; background-color:#ffffff"><span class="css-zv7ju9" style="letter-spacing:0.75pt">A Note for Early Release Readers</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">With Early Release ebooks, you get books in their earliest form—the author’s raw and unedited content as they write—so you can take advantage of these technologies long before the official release of these titles.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">This will be the 4th chapter of the final book. Please note that the GitHub repo will be made active later on.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:48pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">If you have comments about how we might improve the content and/or examples in this book, or if you notice missing material within this chapter, please reach out to the editor at </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">ccollins@oreilly.com</span><span class="css-zv7ju9" style="color:#3d3b49">.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As you have now become familiar with the basics of large language models and the OpenAI API, it’s time to take your skills to the next level. In this chapter, we will help you to delve into the powerful strategies that will enable you to master the true potential of these cutting-edge technologies that are ChatGPT and GPT-4. From mastering prompt engineering, zero-shot, and few-shot learning to fine-tuning models for specific tasks, we will equip you with all the knowledge that you need to create all the innovative and practical applications that you can imagine.</span></p><p class="book-contentsbo-rt-contenth1" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9">Mastering Prompt Engineering Techniques</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In the rest of this section, we will extensively use the chat model’s completion. To make the code more compact, we define the following function:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">def chat_completion(prompt, model='gpt-4', temperature=0):</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">res = openai.ChatCompletion.create(</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">model=model,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">messages=[{'role': 'user', 'content': prompt}],</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">temperature=temperature</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">print(res['choices'][0]['message']['content'])</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">This function receives a prompt and displays the completion result in the terminal. The model and the temperature are two optional features set by default, respectively, to GPT-4 and 0.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To start with prompt engineering, let us return to our primary example with “As Descartes said, I think therefore”. It is not a question nor a specific task that we want. It is just a completion task. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">If this input is passed to GPT-4, it is natural for the model to continue the sentence by iteratively adding the most likely tokens. </span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">chat_completion("As Descartes said, I think therefore")</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We get to the following output message:</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">I am. This famous philosophical statement, also known as "Cogito, ergo sum," emphasizes the existence of the self through the act of thinking or doubting. Descartes used this statement as a foundational principle in his philosophy, arguing that one's own existence is the most certain and indubitable fact that can be known.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">This behavior is often insufficient and does not match what you seek. Prompt engineering is about knowing what to put in this input text to convince the large language model to do what we want. As AI engineers, you must know how to interact with these AI to obtain exploitable results for your apps. You must know how to ask the right questions. You must know how to write quality prompts. This will be the topic of this section. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It’s important to note that prompt engineering can also affect the cost of using the OpenAI API. When you use the API, the amount you pay is a function of the number of tokens you send to the servers of OpenAI, but it’s also a function of the number of tokens you receive from the OpenAI servers. Via the prompts, you can control the number of words generated. As mentioned in Chapter 2, it is also highly recommended to use the parameter </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">max_token</span><span class="css-zv7ju9" style="color:#3d3b49"> to avoid unpleasant surprises on your bills.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">And finally, before exploring the techniques, consider the different parameters you can use in the </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">openai</span><span class="css-zv7ju9" style="color:#3d3b49"> methods as you can get significantly different results with the same prompt if you use parameters like </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">temperature</span><span class="css-zv7ju9" style="color:#3d3b49">, </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">top_p</span><span class="css-zv7ju9" style="color:#3d3b49">, </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">max_token</span><span class="css-zv7ju9" style="color:#3d3b49"> … </span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Designing Effective Prompt</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">There are a lot of tasks that can be performed via prompts. They include summarization, text classification, sentimental analysis, and question answering. This section will present a standard approach common to many technics.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is common to define three parts in a prompt: a </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">context</span><span class="css-zv7ju9" style="color:#3d3b49">, a </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">task</span><span class="css-zv7ju9" style="color:#3d3b49">, and a </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">role,</span><span class="css-zv7ju9" style="color:#3d3b49"> as depicted in </span><a href="https://learning.oreilly.com/library/view/developing-apps-with/9781098152475/ch03.html#fig_1_an_effective_prompt" style="text-decoration:none"><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">Figure</span><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">&#xa0;</span><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">3-1</span></a><span class="css-zv7ju9" style="color:#3d3b49">. All these elements are not always necessary, but if your prompt is well constructed with well-defined pieces, you should get much better results. Note that even with these three elements, it is sometimes not enough to get good results. You may occasionally need to use more advanced techniques for more complex tasks, such as zero-shot or few-shot learning, or even approaches like fine-tuning. We will introduce you to these advanced techniques later in this chapter. </span></p><p class="book-contentsbo-rt-contentfigure" style="margin-top:24pt; margin-right:30pt; margin-left:30pt; text-align:center; background-color:#ffffff"><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.001.png" width="624" height="215" alt="An effective prompt" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9" style="color:#3d3b49"> </span></p><p class="book-contentsbo-rt-contentfigureh6" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; text-align:center; background-color:#ffffff"><span class="sbo-rt-contentspanlabel" style="font-style:italic; color:#3d3b49">Figure 3-1. </span><span class="css-zv7ju9" style="font-style:italic; color:#3d3b49">An effective prompt</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">The context</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The first essential ingredient in a prompt is the context. When you write an input text for an LLM, you must detail the context as much as possible. To illustrate this, let’s take the following situation: you want to create an application to suggest the main course for lunch, and for this, you will use GPT-4. Next, let’s compare what we get with two different contexts. The first one will have little detail, and the second will be much better. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">With few details in the input message.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion("Give me a suggestion for the main course for today's lunch.")</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We get the following output message.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Grilled chicken with roasted vegetables and quinoa.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Now with more details about the context in the input message.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = """</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Context: I do 2 hours of sport a day. I am vegetarian, and I don't like green vegetables. I am conscientious about eating healthily. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Task: Give me a suggestion for a main course for today's lunch."""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We get the following output message.</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">For today's lunch, you can try a Chickpea and Sweet Potato Curry served with Quinoa. This dish is packed with protein, fiber, and essential nutrients, while also being vegetarian and not relying on green vegetables. The curry can be made with chickpeas, sweet potatoes, tomatoes, onions, garlic, and a blend of spices like turmeric, cumin, and coriander. Cook the quinoa separately and serve it alongside the curry for a delicious and healthy meal.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As we can see, with more context, the model has more information about the situation, allowing it to respond more specifically to our request. For example, it suggests a vegetarian dish that is good for health and with proteins for sports. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The context will guide GPT’s thinking to add value to its response. Building a prompt with a good context is an iterative process with often trial-and-error steps. Identifying the essential points that must be put into it is sometimes tricky. To help to determine the possible improvements, you can ask GPT directly for suggestions. As you can see in the following example, we have changed the prompt. Instead of asking it to do the task, we now instruct the model to ask questions about the context. If we answer them, it must help the model to do better completions.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">With the following input message.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = """</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Context: I do 2 hours of sport a day. I am vegetarian and I don't like green vegetables. I am very careful to eat healthily.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Task: Give me a suggestion for a main course for today's lunch?</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Do not perform the requested task! Instead, can you ask me questions about the context so that when I answer, you can perform the requested task more efficiently?</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">"""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We get the following questions from the GPT-4:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Sure, I have a few questions to help me suggest a suitable main course for you:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">1. What type of sport do you do, and do you have any specific nutritional requirements related to it?</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">2. Are there any other vegetables or ingredients that you particularly enjoy or dislike?</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">3. Do you prefer a hot or cold meal for lunch?</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">4. Are you open to trying new recipes or do you prefer sticking to familiar dishes?</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The questions asked by the model are often relevant. Based on that, you can update your context in your prompt. Therefore, we advise you to use this tip often when building your prompt.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">The task</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The task defines your use of the GPT and should be well-defined and specific. Provide sufficient information for the task and use appropriate phrases in the prompt to guide the model to the desired outcome. We already had an example task in the previous section where we asked the model to suggest a main course for lunch.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Feel free to add details to the task to clarify what we want. For example, below, we ask the model to add a table with the ingredients and required quantities of each product in grams.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = """</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Context: I do 2 hours of sport a day. I am vegetarian, and I don't like green vegetables. I am conscientious about eating healthily.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Task: Give me a suggestion for a main course for today's lunch.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">With this suggestion, I also want a table with two columns where each row contains an ingredient from the main course.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">The first column in the table is the name of the ingredient.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">The second column of the table is the number of grams of that ingredient needed for one person. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Do not give the recipe for preparing the main course.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">"""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">And we get the following output from the model:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Suggestion for today's lunch: Stuffed Bell Peppers with Quinoa and Black Beans</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Ingredient</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| Grams per person |</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">|---------------------|------------------|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Bell peppers</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 200g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Quinoa</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 60g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Black beans</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 75g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Onion</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 50g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Garlic</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 5g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Olive oil</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 10g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Tomato sauce</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 50g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Cumin</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 1g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Chili powder</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 1g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Salt</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 1g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Pepper</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 1g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Shredded cheese</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 30g</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">On the OpenAI website (</span><a href="https://platform.openai.com/examples" style="text-decoration:none"><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">https://platform.openai.com/examples</span></a><span class="css-zv7ju9" style="color:#3d3b49">), you have a list with 48 examples of tasks that GPT models can perform with always the associated prompt and with a demo. We won’t go through all of them here, but we will introduce you to a few of them:</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Grammar correction</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Corrects sentences to standard English.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Correct this to standard English: She no went to the market.</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Summarize for a 2nd grader</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Translates complex text into more straightforward concepts.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Summarize this for a second-grade student: Jupiter is the fifth planet [...]</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">TL;DR summarization</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Tl;DR stands for “Too Long; Didn’t Read”. It has been observed that a text can be summarized by simply adding a “tl;dr:” at the end.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">A neutron star [...] atomic nuclei. Tl;dr</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Python to natural language</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Explain a piece of Python code in a language people can understand.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9"># Python 3 </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">def hello(x): </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">print('hello '+str(x)) </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9"># Explanation of what the code does</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Calculate Time Complexity</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Find the time complexity of a function.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9"># Python 3 </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">def hello(x, n):</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">for i in range(n):</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">print('hello '+str(x))</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9"># The time complexity of this function is </span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Python bug fixer</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Fixes a code where there is a bug.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">### Buggy Python</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">def hello(x, n):</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">for i in rang(n):</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">print('hello '+str(x))</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">### Fixed Python</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">SQL request</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Simple SQL query building.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Create a SQL request to find all users who live in California and have over 1000 credits</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Analogy maker</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Can make an analogy between two words.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Create an analogy for this phrase. Questions are arrows in that:</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentstrong" style="color:#3d3b49">Notes to summary</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Summarize notes from a meeting.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prompt:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Convert my shorthand into a first-hand account of the meeting:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Tom: Profits up 50%</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Jane: New servers are online</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; padding:9pt 18pt"><span class="css-zv7ju9">Kjel: Need more time to fix software</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">The role</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">A final classic way to influence the model during the writing of the prompt is to give them a role. This is another way to get it to provide us with a desired response by forcing it to respond in a role-defining way. Of course, the role and context can be used independently, but both increase our control over the model output. In the following example, we put it in the role of a sports nutrition expert. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = """</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Role: You are a nutritionist designing healthy diets for high-performance athletes. You take into account the nutrition needed for a good recovery.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Context: I do 2 hours of sport a day. I am vegetarian, and I don't like green vegetables. I am conscientious about eating healthily.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Task: Based on your expertise defined in your role. Give me a suggestion for a main course for today's lunch. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">With this suggestion, I want also a table with two columns where each row in the table contains an ingredient from the main course.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">The first column in the table is the name of the ingredient.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">The second column of the table is the number of grams of that ingredient needed for one person. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Do not give the recipe for preparing the main course.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">"""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">And we get to following result:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Main Course Suggestion: Quinoa and Chickpea Stuffed Bell Peppers</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Ingredient Table:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Ingredient</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| Grams per Person |</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">|---------------------|------------------|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Quinoa</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 60</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Chickpeas</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 100</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Bell Peppers</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 200</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Olive Oil</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 10</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Onion</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 50</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Garlic</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 5</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Tomato</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 100</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Feta Cheese</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 30</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Kalamata Olives</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 20</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Fresh Basil</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 5</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Salt</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 2</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">| Black Pepper</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">| 1</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">|</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In this example, the role did not change the model’s behavior much. The role and context were probably unnecessary in this case. Still, if your application must have precise control over the output of the model, it is always a good practice to use both in your application.</span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Thinking Step by Step </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Let us return to the computational limitation of GPT discussed in Chapter 1. As we know, GPT-4 can not do 3695 * 123548:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = "How much is 3695 * 123548?"</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We get the following answer: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">454,183,260</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Ok, it is still wrong. The correct answer is 456,509,860. Does GPT not solve complex mathematical problems? It must be remembered that the model does not have access to a calculator. It answers by completion number after number, starting from the left. Numbers are considered like words; there is no mathematical logic. This is why OpenAI models are expected to not know how to solve this type of problem.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Actually, there is a trick to increasing the reasoning capacity of language models. For example, when asked to solve 3695 * 123548, we can see that the model tries to answer directly in one shot. We probably won’t be able to solve this multiplication ourselves without the help of a pencil and a sheet of paper to do the intermediate calculations. It is possible to encourage the model to make intermediate reasonings via the prompt. And like us with our pencil and paper, the model can solve more complex problems if we give it time for reasoning. As we will see, it is straightforward to do.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It turns out that by adding "</span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Let's think step by step</span><span class="css-zv7ju9" style="color:#3d3b49">" to the prompt, the model has empirically proven itself capable of solving more complicated reasoning problems. This technique also called the Zero-shot-CoT strategy, was first introduced in a scientific paper called </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">Large Language Models are Zero-Shot Reasoners</span><span class="css-zv7ju9" style="color:#3d3b49"> by Takeshi Kojima et al., published in 2022. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As we will see, with this sentence added to the prompt, the model begins to reason by breaking the problem into sub-problems. As a result, it can take time to reason, allowing it to find solutions to problems it could not solve before in only one shot. Let’s see what happens if we change our input prompt.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = "How much is 3695 * 123548? Let's think step by step."</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We get the following output:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 1: Multiply 3695 by 8 (the last digit of 123548).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">3695 * 8 = 29,560</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 2: Multiply 3695 by 40 (the last two digits of 123548).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">3695 * 40 = 147,800</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 3: Multiply 3695 by 500 (the last three digits of 123548).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">3695 * 500 = 1,847,500</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 4: Multiply 3695 by 2000 (the last four digits of 123548).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">3695 * 2000 = 7,390,000</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 5: Multiply 3695 by 100000 (the last five digits of 123548).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">3695 * 100000 = 369,500,000</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 6: Add the results from steps 1 to 5.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">29,560 + 147,800 + 1,847,500 + 7,390,000 + 369,500,000 = 379,014,860</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">So, 3695 * 123548 = 379,014,860.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The model’s approach has undergone a notable transformation. Instead of attempting to tackle the problem head-on, it now dissects the primary issue into smaller, more manageable steps. However, it’s essential to maintain a critical perspective, as the model may still produce incorrect answers. For example, the solution it provided, 379,014,860, is not accurate. </span></p><div style="margin:40.5pt 30pt 48pt; border-top:0.75pt solid #8b889a; border-bottom:0.75pt solid #8b889a; clear:both"><p class="book-contentsbo-rt-contentdivdata-typewarningh6" style="line-height:7.5pt; padding-bottom:5.25pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-size:7.5pt; letter-spacing:0.75pt">Warning</span></p><p class="book-contentsbo-rt-contentp" style="line-height:18.9pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-size:11pt; color:#3d3b49">Despite prompting the model to “think step by step,” it remains crucial to carefully evaluate its responses, as GPT is not infallible.</span></p></div><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">What happens with a more straightforward calculation, 369 * 1235? The correct solution is 455,715. When we ask for the answer directly, GPT-4 struggles to give the solution. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = "How much is 369 * 1235?"</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We obtain:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">454965</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">When "</span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Let's think step by step</span><span class="css-zv7ju9" style="color:#3d3b49">" is added in the prompt, the model can compute the correct solution by decomposing the problem into sub-calculations. It can determine the right answer by giving the model more time and space to think. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = "How much is 369 * 1235 ? Let's think step by step."</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We obtain:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 1: Multiply 369 by 5 (the last digit of 1235).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">369 * 5 = 1845</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 2: Multiply 369 by 30 (the second last digit of 1235 is 3, so multiply by 3 and add a 0 at the end).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">369 * 30 = 11070</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 3: Multiply 369 by 200 (the third digit of 1235 is 2, so multiply by 2 and add two 0s at the end).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">369 * 200 = 73800</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 4: Multiply 369 by 1000 (the first digit of 1235 is 1, so multiply by 1 and add three 0s at the end).</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">369 * 1000 = 369000</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Step 5: Add the results from steps 1 to 4.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">1845 + 11070 + 73800 + 369000 = 455715</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">So, 369 * 1235 = 455,715.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Of course, it’s hard to tell from one example if this trick generally works or if we just got lucky. On benchmarks with various math problems, empirical experiments have shown that this trick significantly increased the accuracy of GPT models on math problems. Although this trick works well for most math problems, it is not practical for all situations. The authors of </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">Large Language Models are Zero-Shot Reasoners</span><span class="css-zv7ju9" style="color:#3d3b49"> found it to be most beneficial for problems involving multi-step arithmetic problems, problems involving symbolic reasoning, problems involving strategy, and other issues involving reasoning. It was not found to be useful for common sense problems.</span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Explaining Few-Shot Learning </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Few-shot learning refers to the ability of the large language model to generalize and produce valuable results with only a few examples in the prompt, as illustrated in </span><a href="https://learning.oreilly.com/library/view/developing-apps-with/9781098152475/ch03.html#fig_2_a_prompt_containing_a_few_examples" style="text-decoration:none"><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">Figure</span><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">&#xa0;</span><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">3-2</span></a><span class="css-zv7ju9" style="color:#3d3b49">. In the few-shot learning, you give a few examples of the task you want the model to perform. These examples guide the model to understand the desired output format and the problem-solving process.</span></p><p class="book-contentsbo-rt-contentfigure" style="margin-top:24pt; margin-right:30pt; margin-left:30pt; text-align:center; background-color:#ffffff"><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.002.png" width="624" height="212" alt="A prompt containing a few examples" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9" style="color:#3d3b49"> </span></p><p class="book-contentsbo-rt-contentfigureh6" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; text-align:center; background-color:#ffffff"><span class="sbo-rt-contentspanlabel" style="font-style:italic; color:#3d3b49">Figure 3-2. </span><span class="css-zv7ju9" style="font-style:italic; color:#3d3b49">A prompt containing a few examples</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Let’s consider an example where we ask the LLM to convert specific words into emojis. It is difficult to imagine the instructions to put in the prompt to do this task. But, with few-shot learning, it’s easy. Give it examples, and the model will automatically try to reproduce them. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">prompt = """</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">I go home --&gt; </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.003.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> go </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.004.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">my dog is sad --&gt; my </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.005.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> is </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.006.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">I run fast --&gt; </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.003.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> run </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.007.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">I love my wife --&gt; </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.003.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.008.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> my wife</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">the girl plays with the ball --&gt; the </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.009.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.010.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> with the </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.011.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">The boy writes a letter to a girl --&gt; </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">"""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">chat_completion(prompt)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">And we get as output the following message:</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">The </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.012.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9">️ a </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.013.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9"> to a </span><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.009.png" width="160" height="160" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The few-shot learning technique gives examples of prompts with the desired result. Then, in the last line, we provide the prompt for which we want a completion. This prompt is in the same form as in the examples above. Naturally, the language model will perform a completion operation considering the pattern of the examples above.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We can see that with only a few examples, the model understands and can reproduce the instructions. By leveraging the extensive knowledge LLMs have acquired in their training phase, they can quickly adapt and generate accurate answers based on only a few examples. Few-shot learning is a powerful aspect of LLMs because it allows them to be highly flexible and adaptable, requiring only a limited amount of additional information to perform various tasks.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">When you provide examples in the prompt, it is essential to ensure the context is clear and relevant. Clear examples help the model better understand the desired output format and the problem-solving process. Conversely, inadequate or ambiguous examples can lead to unexpected or incorrect results. Therefore, writing examples carefully and ensuring they convey the correct information can significantly impact the model’s ability to perform the task accurately.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In addition to few-shot learning, another approach to guiding LLMs is one-shot learning. As its name indicates, in this case, you provide only one example to help the model to understand the task. Although this approach provides less guidance than few-shot learning, it can be effective for more straightforward tasks or when the LLM already has substantial background knowledge about the topic. The advantages of one-shot learning are simplicity, faster prompt generation, and lower computational cost. However, for complex tasks or situations that require a deeper understanding of the desired outcome, few-shot learning might be a more suitable approach to ensure accurate results. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To optimize the performance of LLMs, we have explored various techniques of prompt engineering. This process involves refining the prompt to guide the model more effectively, which can lead to better results, especially when dealing with more complex tasks. We have discussed different techniques in this section, such as defining the role, task, and context, using the sentence ‘Let’s think step by step’ to encourage the model to engage in stepwise reasoning, and employing few-shot learning.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We have provided you with a toolbox of techniques. You can combine these tools to achieve the best results. However, it is your responsibility to find the most effective prompt for your specific problem through an iterative process of experimentation.</span></p><p class="book-contentsbo-rt-contenth1" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9">Unleashing the Power of GPT with Fine-Tuning</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">OpenAI provides us with many ready-to-use GPT models. Although the latest models proposed by OpenAI can perform very well on various tasks, it is sometimes possible to improve the text generated by making the model more specific for certain jobs or usage contexts. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To be more concrete, let us suppose, for example, that you want to create an email response generator for your company. As your company works in a specific industry with a particular vocabulary, you want the generated email responses to retain your current writing style. There are two strategies for doing this: either you use prompt engineering techniques introduced before to force the model to output the text you want, or you fine-tune an existing model. In this section, we will explore the second technique. To do that, you must collect a large amount of data with emails, about your particular business domain, with inquiries from customers and the corresponding responses. You can then use these data to fine-tune an existing model to learn your company’s specific language patterns and vocabulary. The fine-tuned model is really a new model built from one of the original models provided by OpenAI, in which the internal weights of the model are adjusted to fit your specific problem so that the new model increases its accuracy on tasks similar to the examples that it saw in the dataset provided for the fine-tuning. By fine-tuning an existing large language model, it is possible to create a highly customized and specialized email response generator tailored explicitly to the language patterns and words used in your particular business.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Figure </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">4-3 </span><span class="css-zv7ju9" style="color:#3d3b49">illustrates the fine-tuning process where a dataset from a specific domain is used to update the internal weights of an existing GPT model. The objective is that the new fine-tuned model makes better predictions in the particular domain than the original GPT model. It should be noted that this is a new model. This new model is on the OpenAI servers; loading them in locally is impossible. As before, you must use the OpenAI APIs to use them.</span></p><p class="book-contentsbo-rt-contentfigure" style="margin-top:24pt; margin-right:30pt; margin-left:30pt; text-align:center; background-color:#ffffff"><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.014.png" width="624" height="392" alt="The fine tuning process." style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9" style="color:#3d3b49"> </span></p><p class="book-contentsbo-rt-contentfigureh6" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; text-align:center; background-color:#ffffff"><span class="sbo-rt-contentspanlabel" style="font-style:italic; color:#3d3b49">Figure 3-3. </span><span class="css-zv7ju9" style="font-style:italic; color:#3d3b49">The fine-tuning process.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Fine-tuning is thus a process of retraining an existing model on a set of data from a specific task to improve its performance and make its answers more accurate. In fine-tuning, you update the internal parameters of the model. As we saw before, few-shot learning is another technic. It refers to providing the model with a limited number of good examples through its input prompt, which guides the model to produce desired results based on these few examples. With few-shot learning, the internal parameters of the model are not modified. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Both fine-tuning and few-shot learning have the possibility of adapting GPT models. Fine-tuning produces a highly specialized model that can provide more accurate and contextually relevant results for a given task. This makes it an ideal choice for cases where a large amount of data is available from our task. This customization ensures the generated content is better aligned with the target domain’s specific language patterns, vocabulary, and tone. On the other hand, few-shot learning is a more flexible and data-efficient approach because it does not require retraining the model. This technique is beneficial when limited examples are available or rapid adaptation to different tasks is needed. Few-shot learning allows developers to quickly prototype and experiment with various tasks, making it a versatile and practical option for many use cases. Another essential criterion for choosing between the two methods is that using and training a model that uses fine-tuning is more expensive.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Fine-tuning methods often require vast amounts of data. The lack of available examples often limits the use of this type of technique. To give you an idea of the amount of data needed for fine-tuning, you can assume that for relatively simple tasks or when only minor adjustments are required, you may achieve good fine-tuning results with a few hundred examples of input prompts with their corresponding wanted completion. This approach may suit tasks where the pre-trained existing GPT model performs reasonably well but needs slight refinements to better align with the target domain. However, for more complex tasks or when your app needs more customization, you may need thousands or even tens of thousands of examples. This can, for example, correspond to the use case we presented earlier, i.e., the automatic response to an e-mail that respects our writing style. It is also possible to apply fine-tuning techniques for highly specialized tasks or when the model needs to learn a substantial amount of new domain-specific knowledge. In this case, the amount of data can be huge. You might need hundreds of thousands of examples or even millions. This fine-tuning scale can lead to significant performance improvements and better model adaptation to the specific domain. </span></p><div style="margin:40.5pt 30pt 48pt; border-top:0.75pt solid #8b889a; border-bottom:0.75pt solid #8b889a; clear:both"><p class="book-contentsbo-rt-contentdivdata-typenoteh6" style="line-height:7.5pt; padding-bottom:5.25pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-size:7.5pt; letter-spacing:0.75pt">Note</span></p><p class="book-contentsbo-rt-contentp" style="line-height:18.9pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-size:11pt; color:#3d3b49">Transfer learning applies knowledge learned from one domain to a different but related environment. Therefore, you may sometimes hear the term transfer learning for fine-tuning. </span></p></div><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Exploring Fine-Tuning Applications </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The fine-tuning of models has many applications. In this section, we will show you different use cases where it can be used to improve model performance. Take inspiration from these examples and see if you have the same problem in your use case. Once again, fine-tuning will not be necessary for most situations, but when it is, this technique can significantly improve the results.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Legal document analysis</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In this use case, an LLM is used to process legal texts and extract valuable information. These documents are often written with specific jargon, making it difficult for non-specialists to understand these types of texts. We have already seen that when tested on the Uniform Bar Exam, GPT-4 achieves the excellent score of being in the 90th percentile of the best students. For example, a use case could specialize the model for a specific domain and/or allow it to assist non-specialists in their legal process. By fine-tuning an LLM on a legal corpus of a particular topic or for a specific type of end-user, the model can better understand the intricacies of legal language and become more adept at performing tasks related to that particular type of end-user.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Fine-tuning an LLM with a large amount of data to analyze legal documents can potentially significantly improve the model’s performance in these tasks by allowing it to understand better the nuances of legal language that are often beyond the capabilities of prompt engineering techniques.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Automated code review</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In this use case, a model can be fine-tuned to analyze code provided by a developer and make suggestions to improve its quality. This use case involves specializing a model on a dataset containing, for example, code snippets and comments to enable the LLM to understand the syntax, semantics, and best practices associated with that language. Note that this use case is similar to what GitHub does in Copilot, a tool designed to assist developers in writing code by providing suggestions of code and entire functions in real time. But you can use it as inspiration to adapt it to your own code from your company or if you are using a particular programming framework.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As an example of an input file for this use case, your JSONL file could contain pairs of code and their corresponding review comments. This will help the model learn how to provide accurate and relevant feedback on code quality. One line of the JSONL file could be something like this:</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt 24pt"><span class="css-zv7ju9">{"</span><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">prompt</span><span class="css-zv7ju9">": "Review the following Python code: 'def sum(a, b): return a + b\nresult = sum(5, '5')'", "</span><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">completion</span><span class="css-zv7ju9">": "Type error: The 'sum' function is adding an integer and a string. Consider converting the string to an integer using int() before passing it to the function."}</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Financial document summarization</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In financial document synthesis, a fine-tuned LLM can generate concise and accurate summaries of financial documents, such as earnings reports, financial statements, and analyst reports. By fine-tuning a language model on a dataset related explicitly to financial records, the resulting model becomes more accurate in understanding the terminology and context of these documents, enabling it to generate more informative summaries.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To adjust an existing model to get better summaries of financial documents, you need to already have a large number of sample summaries. Based on this, you have to provide the model with a JSONL file containing pairs of financial documents and their ideal summaries. Here is a small example:</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt 24pt"><span class="css-zv7ju9">{"</span><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">prompt</span><span class="css-zv7ju9">": "The central bank announced a 0.25% increase in the benchmark interest rate, citing concerns about inflationary pressures. This move is expected to affect borrowing costs for consumers and businesses.", "</span><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">completion</span><span class="css-zv7ju9">": "Bank increases rate 0.25% for inflation worry. May affect people, business borrowing costs."}</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Technical document translation</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Using fine-tuning to translate technical documents can significantly improve the performance of a base model compared to what we can obtain with few-shot learning. The main reason is that technical documents often contain specialized vocabulary and complex sentence structures that few-shot learning cannot handle effectively. Therefore, to adapt an existing based model, you have to prepare a JSONL file containing your training data. For the use case of technical document translation, the contents of this file would include translations of technical texts into the target language.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">News article generation for niche topics</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In this use case, a fine-tuned model could generate high-quality, engaging, and contextually relevant news articles for highly specialized topics that the base model probably would not have seen enough to be accurate. As with all other use cases, we need to create a training dataset to specialize our model to write articles. For that, we need to have many articles written on that specific niche topic at our disposal. These data will be used to create our JSONL file containing prompt-completion pairs. Here is a small example:</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt 24pt"><span class="css-zv7ju9">{"</span><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">prompt</span><span class="css-zv7ju9">": "Write an introductory article about a new environmentally-friendly cryptocurrency: 'EcoCoin: The Green Cryptocurrency Taking the Market by Storm'", "</span><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">completion</span><span class="css-zv7ju9">": "As concerns over the environmental impact of cryptocurrency mining (...) mining process and commitment to sustainability."}</span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Preparing your Data for Fine-Tuning</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To update an LLM model, it is necessary to provide a data set with examples. It should be in a JSONL file where each row corresponds to a pair of prompts and completions. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">{"prompt": "&lt;prompt text&gt;", "completion": "&lt;completion text&gt;"}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">{"prompt": "&lt;prompt text&gt;", "completion": "&lt;completion text&gt;"}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">{"prompt": "&lt;prompt text&gt;", "completion": "&lt;completion text&gt;"}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">...</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">A JSONL file is a text file in which each line contains a single JSON object, providing an efficient and convenient way to store and process large amounts of structured data. OpenAI provides a tool that helps you generate this training file. This tool can take various file formats as input (CSV, TSV, XLSX, JSON, or JSONL), requiring only that they contain a prompt and completion column/key and output a training JSONL file ready to be sent for the fine-tuning process. This tool also validates and gives suggestions to improve the quality of your data.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To run this tool in your terminal: </span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">openai tools fine_tunes.prepare_data -f &lt;LOCAL_FILE&gt;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The application will make a series of suggestions to improve the result of the final file; you can accept them or not. You can also specify the option </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">-q,</span><span class="css-zv7ju9" style="color:#3d3b49"> which auto-accepts all suggestions.</span></p><div style="margin:40.5pt 30pt 48pt; border-top:0.75pt solid #8b889a; border-bottom:0.75pt solid #8b889a; clear:both"><p class="book-contentsbo-rt-contentdivdata-typenoteh6" style="line-height:7.5pt; padding-bottom:5.25pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-size:7.5pt; letter-spacing:0.75pt">Note</span></p><p class="book-contentsbo-rt-contentp" style="line-height:18.9pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-size:11pt; color:#3d3b49">This </span><span class="book-contentsbo-rt-contentcode" style="font-size:11pt; color:#3d3b49">openai</span><span class="css-zv7ju9" style="font-size:11pt; color:#3d3b49"> tool was installed and available in your terminal when you executed </span><span class="book-contentsbo-rt-contentcode" style="font-size:11pt; color:#3d3b49">pip install openai</span><span class="css-zv7ju9" style="font-size:11pt; color:#3d3b49">.</span></p></div><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">If you have enough data, the tool will ask if dividing the data into training and validation sets is necessary. It is an excellent practice. The algorithm will use the training data to modify the model’s parameters during fine-tuning. The validation set can measure the model’s performance on a dataset that has not been used to update the parameters. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Fine-tuning an LLM benefits from using high-quality examples, ideally reviewed by experts. When fine-tuning with pre-existing datasets, ensure that the data is screened for offensive or inaccurate content or examine random samples if the dataset is too large to review all entries manually.</span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Adapting GPT Base Models for Domain-Specific Needs</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Currently, fine-tuning is only available for the base models: davinci, curie, babbage, and ada. Each of these modes offers a trade-off between accuracy and resource needed. As developers, you can select the most appropriate model for your application. While the smaller models, such as ada and babbage, may be faster and more cost-effective for simple tasks or applications with limited resources, the larger models, such as curie and davinci, offer more advanced language understanding and generation capabilities, making them ideal for more complex tasks where higher accuracy are critical.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">These are the original models that are not part of the instructGPT family of models. For example, they did not benefit from a reinforcement learning phase with a human in the loop. By fine-tuning these base models, you can tailor them to specific tasks or domains by adjusting their internal weights based on a custom dataset. Although they do not have the reinforcement learning capabilities of the instructGPT family, they provide a strong foundation for building specialized applications by leveraging their pre-trained language understanding and generation capabilities.</span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Mastering Fine-Tuning with the OpenAI API</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In this section, we will guide you through fine-tuning an LLM using the OpenAI API, which can significantly improve its performance for specific tasks. We will discuss how to manipulate files, upload datasets, and create a fine-tuned model using the API, allowing you to build powerful applications tailored to your needs.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Manipulating files</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">First, you need to upload the files to the OpenAI servers. The OpenAI API provides different functions to manipulate files, and among them, the most important ones are: </span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">Upload file</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Upload a file that can be used for different endpoints. Currently, the total file size can be up to 1 GB. For more, you need to contact OpenAI.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:66pt; padding:9pt 18pt"><span class="css-zv7ju9">openai.File.create(</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:66pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">file=open("out_openai_completion_prepared.jsonl", "rb"),</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:66pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">purpose='fine-tune'</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Two parameters are mandatory </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">file</span><span class="css-zv7ju9" style="color:#3d3b49"> and </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">purpose.</span><span class="css-zv7ju9" style="color:#3d3b49"> For the second one, set it to </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">'fine-tune'.</span><span class="css-zv7ju9" style="color:#3d3b49"> This validates the downloaded file format for fine-tuning. The output of this function is a dictionary in which you can retrieve the ‘file_id’ in the ‘id’ field. </span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="css-zv7ju9" style="font-style:italic; color:#3d3b49">Delete a file</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt 18pt 84pt"><span class="css-zv7ju9">openai.File.delete("file-z5mGr9LesKsYu7vrEveakYUI")</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:66pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">One parameter is mandatory: the file_id</span></p><p style="margin-right:30pt; margin-left:48pt; line-height:21pt; background-color:#ffffff"><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">List files</span></p><p class="book-contentsbo-rt-contentp" style="margin:7.5pt 30pt 18pt 66pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Get a list of all uploaded files. It can be helpful to find back the ID of a file. </span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt 24pt"><span class="css-zv7ju9">openai.File.list()</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Creating a fine-tuned model</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is straightforward to fine-tune with a downloaded file. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The endpoint </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">openai.FineTune.create()</span><span class="css-zv7ju9" style="color:#3d3b49"> creates a job on the OpenAI servers to refine a specified model from a given data set. The response of this function contains the details of the queued job, including the status of the job, the </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id</span><span class="css-zv7ju9" style="color:#3d3b49">, and the names of the model at the end of the process.</span></p><p class="book-contentsbo-rt-contenth4" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Main input parameters</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">training_file</span><span class="css-zv7ju9"> string</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is the only mandatory parameter containing the </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">file_id</span><span class="css-zv7ju9" style="color:#3d3b49"> of the uploaded file. Your data set must be formatted as a JSONL file. Each training example is a JSON object with the keys “prompt” and “completion”. </span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">model </span><span class="css-zv7ju9">string</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It specifies the base model used for fine-tuning. You can select ada, babbage, curie, davinci, or a previously tuned model. The default base model is curie. </span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">validation_file</span><span class="css-zv7ju9"> string</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It contains the </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">file_id</span><span class="css-zv7ju9" style="color:#3d3b49"> of the uploaded file with the validation data. If you provide this file, the data will be used to generate validation metrics periodically during fine-tuning.</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="book-contentsbo-rt-contentstrong" style="font-family:'Courier New'">suffix</span><span class="css-zv7ju9"> string</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is a string of 40 characters maximum is added to your custom model name.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Cancel a fine-tuning job</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is possible to immediately interrupt a job running on OpenAI servers via the following function.</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">openai.FineTune.cancel()</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">This function has only one mandatory parameter: </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id</span><span class="css-zv7ju9" style="color:#3d3b49"> is a string like “</span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">ft-Re12otqdRaJ(...)</span><span class="css-zv7ju9" style="color:#3d3b49">” starting with “</span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">ft-</span><span class="css-zv7ju9" style="color:#3d3b49">”. It is obtained after the creation of your job with the function </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">openai.FineTune.create().</span><span class="css-zv7ju9" style="color:#3d3b49"> If you have lost your </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id</span><span class="css-zv7ju9" style="color:#3d3b49">, you can find it back with the </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">openai.FineTune.list().</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">List of fine-tuning jobs</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is possible to obtain the list of all the fine-tuning works on the OpenAI servers via the following function. </span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">openai.FineTune.list().</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The result is a dictionary that contains information for all the refined models. </span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Generating Synthetic Data and Fine-Tuning for an </span><span class="sbo-rt-contentspankeep-together">Email Marketing Campaigns Tool</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In this example, we will make a text-generation tool for an email marketing agency that utilizes targeted content to create personalized email campaigns for businesses. The emails are designed to engage audiences and promote products or services. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Let’s assume that our agency has a client in the payment processing industry who has asked to help them to run a direct email marketing campaign to offer stores a new payment service for e-commerce. The email marketing agency decides to use fine-tuning techniques for this project. To do that, a large amount of data is needed. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As we do not have such examples, we will generate them synthetically in this section. But note that in reality, the data should not be artificially generated and must come from human experts.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Creating a synthetic data set for fine-tuning:</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In the following example, we create artificial data from GPT-3.5-Turbo. To do that, we will specify in a prompt that we want promotional sentences to sell the e-commerce service to a specific merchant. The merchant is characterized by a sector of activity, the city where the store is located, and the size of the store. We get promotional sentences by sending the prompts to the GPT-3.5-Turbo via the function </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">chat_completion</span><span class="css-zv7ju9" style="color:#3d3b49"> defined above</span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We start by defining three lists that correspond to the type of industry, the cities where the stores are located, and the size of the stores.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">l_sector = ['Grocery Stores', 'Restaurants', 'Fast Food Restaurants', 'Pharmacies', 'Service Stations (Fuel)', 'Electronics Stores']</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">l_city = ['Brussels', 'Paris', 'Berlin']</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">l_size = ['small', 'medium', 'large'] </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Then we define a first prompt in a string. In this prompt, the role, context, and task are well defined; we use the prompt engineering techniques described earlier in this chapter. In this string, the three values between the braces are replaced with the corresponding values later in the code. This first prompt is used to generate the synthetic.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">f_prompt = """ </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Role: You are an expert content writer with extensive direct marketing experience. You have strong writing skills, creativity, adaptability to different tones and styles, and a deep understanding of audience needs and preferences for effective direct campaigns.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Context: You have to write a short message in maximum 2 sentences for a direct marketing campaign to sell a new e-commerce payment service to stores. </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">The target stores have the three following characteristics:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- The sector of activity: {sector}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- The city where the stores are located: {city} </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- The size of the stores: {size}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Task: Write the short message for the direct marketing campaign. Use the skills defined in your role to write this message! It is very important that the message you create takes into account the product you are selling and the characteristics of the store you are writing to.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">"""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The following prompt contains only the values of the three variables, separated by commas. It is not used to create the syntactic data but for fine-tuning.</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">f_sub_prompt = "{sector}, {city}, {size}"</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Then comes the main part of the code, which iterates over the three value lists we defined earlier. We can see that the code of the block in the loop is straightforward. We replace the values in the braces of the two prompts with the appropriate values. The variable </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">prompt</span><span class="css-zv7ju9" style="color:#3d3b49"> is used with the function </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">chat_completion</span><span class="css-zv7ju9" style="color:#3d3b49"> to generate an advertisement saved in </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">response_txt</span><span class="css-zv7ju9" style="color:#3d3b49">. The </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">sub_prompt</span><span class="css-zv7ju9" style="color:#3d3b49"> and </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">response_txt</span><span class="css-zv7ju9" style="color:#3d3b49"> variables are then added to the </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">out_openai_completion.csv</span><span class="css-zv7ju9" style="color:#3d3b49"> file, our training set for fine-tuning.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">df = pd.DataFrame()</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">for sector in l_sector:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span><span class="css-zv7ju9">for city in l_city:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">for size in l_size:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0; </span><span class="css-zv7ju9">for i in range(3): ## 3 times each</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">prompt = f_prompt.format(sector=sector, city=city, size=size)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">sub_prompt = f_sub_prompt.format(sector=sector, city=city, size=size)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">response_txt = chat_completion(prompt, model='gpt-3.5-turbo', temperature=1)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">new_row = {</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">'prompt':sub_prompt, </span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">'completion':response_txt}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">new_row = pd.DataFrame([new_row])</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">df = pd.concat([df, new_row], axis=0, ignore_index=True)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">df.to_csv("out_openai_completion.csv",</span><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">index=False)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Note that for each combination of characteristics, we produce three examples. And to maximize the model’s creativity, we set the temperature to 1. At the end of this script, we have a Pandas table stored in the file </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">out_openai_completion.csv</span><span class="css-zv7ju9" style="color:#3d3b49">. It contains 162 observations, with two columns containing the prompt and the corresponding completion. Here are the first two lines of this file.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">"Grocery Stores, Brussels, small",Introducing our new e-commerce payment service - the perfect solution for small Brussels-based grocery stores to easily and securely process online transactions.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">"Grocery Stores, Brussels, small",Looking for a hassle-free payment solution for your small grocery store in Brussels? Our new e-commerce payment service is here to simplify your transactions and increase your revenue. Try it now!</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We can now call the tool to generate the training file from </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">out_openai_completion.csv</span><span class="css-zv7ju9" style="color:#3d3b49"> as follow:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">openai tools fine_tunes.prepare_data -f out_openai_completion.csv</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As you can see in the following, this tool makes suggestions for improving our prompt/complement pairs. At the end of this text, it even gives instructions on how to continue the fine-tuning process and advice on using the model to make predictions once the fine-tuning process is complete.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">$ openai tools fine_tunes.prepare_data -f out_openai_completion.csv</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Analyzing...</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- Based on your file extension, your file is formatted as a CSV file</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- Your file contains 162 prompt-completion pairs</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- Your data does not contain a common separator at the end of your prompts. Having a separator string appended to the end of the prompt makes it clearer to the fine-tuned model where the completion should begin. See https://platform.openai.com/docs/guides/fine-tuning/preparing-your-dataset for more detail and examples. If you intend to do open-ended generation, then you should leave the prompts empty</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- Your data does not contain a common ending at the end of your completions. Having a common ending string appended to the end of the completion makes it clearer to the fine-tuned model where the completion should end. See https://platform.openai.com/docs/guides/fine-tuning/preparing-your-dataset for more detail and examples.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- The completion should start with a whitespace character (` `). This tends to produce better results due to the tokenization we use. See https://platform.openai.com/docs/guides/fine-tuning/preparing-your-dataset for more details</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Based on the analysis we will perform the following actions:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- [Necessary] Your format `CSV` will be converted to `JSONL`</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- [Recommended] Add a suffix separator ` -&gt;` to all prompts [Y/n]: Y</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- [Recommended] Add a suffix ending `\n` to all completions [Y/n]: Y</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">- [Recommended] Add a whitespace character to the beginning of the completion [Y/n]: Y</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Your data will be written to a new JSONL file. Proceed [Y/n]: Y</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Wrote modified file to `out_openai_completion_prepared.jsonl`</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Feel free to take a look!</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Now use that file when fine-tuning:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">&gt; openai api fine_tunes.create -t "out_openai_completion_prepared.jsonl"</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">After you’ve fine-tuned a model, remember that your prompt has to end with the indicator string ` -&gt;` for the model to start generating completions, rather than continuing with the prompt. Make sure to include `stop=["\n"]` so that the generated texts ends at the expected place.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Once your model starts training, it'll approximately take 4.67 minutes to train a `curie` model, and less for `ada` and `babbage`. Queue will approximately take half an hour per job ahead of you.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">At the end of this process, a new file called </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">out_openai_completion_prepared.jsonl</span><span class="css-zv7ju9" style="color:#3d3b49"> is available and ready to be sent to OpenAI servers to run the fine-tuning process. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Note that, as explained in the message of the function, the prompt has been modified by adding the string ‘ -&gt;’ at the end, and a suffix ending with “\n” has been added to all completions.</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Fine-tuning a model with the synthetic data set</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The following code uploads the file and does the fine-tuning. In this example, we will use davinci as base model, and the name of the resulting model will have ‘direct_marketing’ as a suffix.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">ft_file = openai.File.create(</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">file=open("out_openai_completion_prepared.jsonl", "rb"),</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">purpose='fine-tune'</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">openai.FineTune.create(training_file=ft_file['id'], model='davinci', suffix='direct_marketing')</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">After some time, you will have a new model that is adapted to your needs and ready to use. The time required for learning depends on the number of observations in your dataset and the type of based model used. In our case, it took less than five minutes.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is also possible to fine-tune directly from the command line terminal. For example, in the following, we use davinci as our base model and request that our new model carry the suffix direct_marketing.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">$ openai api fine_tunes.create -t out_openai_completion_prepared.jsonl -m davinci --suffix "direct_marketing"</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Upload progress: 100%|| 40.8k/40.8k [00:00&lt;00:00, 65.5Mit/s]</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Uploaded file from out_openai_completion_prepared.jsonl: file-z5mGr9LesKsYu7vrEveakYUI</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Created fine-tune: ft-mMsmLdhtffr54d</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">Streaming events until fine-tuning is complete...</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">(Ctrl-C will interrupt the stream, but not cancel the fine-tune)</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Created fine-tune: ft-mMsmLdhtffr54d</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Fine-tune costs $0.84</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Fine-tune enqueued. Queue number: 0</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Fine-tune started</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Completed epoch 1/4</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Completed epoch 2/4</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Completed epoch 3/4</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">[] Completed epoch 4/4</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">It is important to note that if you do a </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">Ctrl-C</span><span class="css-zv7ju9" style="color:#3d3b49"> in the command line, the connection to the servers of OpenAI will be canceled, but it will not interrupt the fine-tuning process. </span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To reconnect to the server and find out the status of a fine-tuning job, you can use the following command where </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id</span><span class="css-zv7ju9" style="color:#3d3b49"> is the ID of the fine-tune job and is given when you have created the job. In our example above, our </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id</span><span class="css-zv7ju9" style="color:#3d3b49"> is </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">ft-mMsmLdhtffr54d</span><span class="css-zv7ju9" style="color:#3d3b49">.</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">$ openai api fine_tunes.follow -i &lt;fine_tune_id&gt;</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">If you lost the </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">fine_tune_id</span><span class="css-zv7ju9" style="color:#3d3b49">, it is possible to display all models via:</span></p><p class="book-contentsbo-rt-contentpre" style="margin:18pt 48pt"><span class="css-zv7ju9">$ openai api fine_tunes.list</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To immediately cancel a fine-tune job:</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">$ openai api fine_tunes.cancel -i &lt;fine_tune_id&gt;</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;</span></p><p class="book-contentsbo-rt-contenth3" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Use a new fine-tuned model for completion.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Once your new model is built, it can be accessed in different ways to make new completions. The easiest way to test it is probably via the playground. In this tool, to access the model, you can search for it in the right drop-down menu containing the list of models. All your fine-tuned models are at the bottom of this list. Once selected, you can use it to make predictions.</span></p><p class="book-contentsbo-rt-contentfigure" style="margin:24pt 30pt; text-align:center; background-color:#ffffff"><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.015.png" width="624" height="325" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9" style="color:#3d3b49"> </span></p><p class="book-contentsbo-rt-contentp" style="margin:24pt 30pt 18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We used the fine-tuned LLM in the following example with the input prompt ‘Hotel, New York, small -&gt;'. Without further instructions, the model automatically generated an advertisement to sell an e-commerce payment service for a small hotel in New York.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Note that we already obtained excellent results with a small data set comprising only 162 examples. For a fine-tuning task, it is generally recommended to have several hundred instances, ideally several thousand. In addition, our training set was generated synthetically when ideally, it should have been written by a human expert in marketing.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To use it with the OpenAI API, we proceed exactly as before with </span><span class="book-contentsbo-rt-contentcode" style="color:#3d3b49">openai.Completion.create()</span><span class="css-zv7ju9" style="color:#3d3b49">, except that we need to put the name of our new model as an input parameter. Don’t forget to end all your prompts with ‘ -&gt;’ and set “\n” as stop words.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">openai.Completion.create(</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">model="davinci:ft-worldline:direct-marketing-2023-05-01-15-20-35",</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">prompt="Hotel, New York, small -&gt;",</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">max_tokens=100,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">temperature=0,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">stop="\n"</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; padding:9pt 18pt"><span class="css-zv7ju9">)</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">We obtain the following answer.</span></p><p class="book-contentsbo-rt-contentpre" style="margin-top:18pt; margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9">&lt;OpenAIObject text_completion id=cmpl-7BTkLPoH7U2elytJifUsvz0X4ixbd at 0x7f234ca5c220&gt; JSON: {</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">"choices": [</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">{</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"finish_reason": "stop",</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"index": 0,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"logprobs": null,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"text": " \"Upgrade your hotel's payment system with our new e-commerce service, designed for small businesses in New York City. Say goodbye to clunky payment systems and hello to seamless transactions.\""</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">],</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">"created": 1682970309,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">"id": "cmpl-7BTkLPoH7U2elytJifUsvz0X4ixbd",</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">"model": "davinci:ft-worldline:direct-marketing-2023-05-01-15-20-35",</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">"object": "text_completion",</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">"usage": {</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"completion_tokens": 37,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"prompt_tokens": 8,</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0;&#xa0;&#xa0; </span><span class="css-zv7ju9">"total_tokens": 45</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; padding:9pt 18pt"><span class="css-zv7ju9" style="-aw-import:spaces">&#xa0; </span><span class="css-zv7ju9">}</span></p><p class="book-contentsbo-rt-contentpre" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; padding:9pt 18pt"><span class="css-zv7ju9">}</span></p><p class="book-contentsbo-rt-contenth2" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9">Evaluating Price Implications of Fine-Tuning</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">The use of fine-tuned models is costly. You have to pay for the training, and once the model is ready, each prediction will cost you a little more than if you had used the basic models provided by OpenAI.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">Prices are subject to change, but at the time of this writing, we had:</span></p><p class="book-contentsbo-rt-contentfigurep" style="margin:24pt 30pt 18pt; padding-top:4pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">In order to allow an easy price comparison, the price of model</span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49"> gpt-3.5-turbo</span><span class="css-zv7ju9" style="color:#3d3b49"> is $0.002 / 1K tokens. As already mentioned, </span><span class="book-contentsbo-rt-contentem" style="color:#3d3b49">gpt-3.5-turbo</span><span class="css-zv7ju9" style="color:#3d3b49"> is the recommender model with the best performance for money.</span></p><p style="margin-right:30pt; margin-left:30pt; text-align:center; line-height:18pt; background-color:#ffffff"><img src="images/Aspose.Words.c76afd1e-488d-4f8b-9529-d2fdfcd16fd5.016.png" width="624" height="175" alt="" style="-aw-left-pos:0pt; -aw-rel-hpos:column; -aw-rel-vpos:paragraph; -aw-top-pos:0pt; -aw-wrap-type:inline" /><span class="css-zv7ju9" style="color:#3d3b49"> </span></p><p class="book-contentsbo-rt-contentfigurep" style="margin:18pt 30pt 24pt; padding-top:4pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To get the latest prices, visit </span><a href="https://openai.com/pricing" style="text-decoration:none"><span class="book-contentsbo-rt-contentalink" style="text-decoration:underline">OpenAI pricing page</span></a><span class="css-zv7ju9" style="color:#3d3b49">.</span></p><p class="book-contentsbo-rt-contenth1" style="margin-right:30pt; margin-left:30pt; margin-bottom:24pt; background-color:#ffffff"><span class="css-zv7ju9">Summary</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">This chapter has provided the reader with advanced techniques to unlock the full potential of GPT-4 and ChatGPT and has provided key actionable takeaways to improve the development of applications using LLMs. Developers can benefit from understanding prompt engineering, zero-shot and few-shot learning, and fine-tuning to create more effective and targeted applications. We explored how to create effective prompts by considering context, task, and role, which enables more precise interactions with the models. By demonstrating the benefits of step-by-step reasoning, developers can encourage the model to reason more effectively and handle complex tasks. In addition, we discussed the flexibility and adaptability that few-shot learning offers, highlighting its data-efficient nature and ability to adapt to different tasks quickly.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:18pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">To ensure success in building LLM applications, developers should experiment with other techniques and evaluate the model’s responses for accuracy and relevance. In addition, developers should be aware of LLM’s computational limitations and adjust their prompts accordingly to achieve better results. By integrating these advanced techniques and continually refining their approach, developers can create powerful and innovative applications that unlock the true potential of GPT-4 and ChatGPT.</span></p><p class="book-contentsbo-rt-contentp" style="margin-right:30pt; margin-left:30pt; margin-bottom:60pt; background-color:#ffffff"><span class="css-zv7ju9" style="color:#3d3b49">As we move forward, you will discover in the next chapter other emerging ways of integrating LLM capabilities into your applications. You will notably see plug-ins and LangChain. These tools enable developers to create innovative applications, access up-to-date information, and simplify app development integrating LLMs. We will also provide insight into the future of large language models and their impact on app development.</span></p><p style="margin-right:30pt; margin-left:30pt; font-size:21pt"><span style="width:6pt; font-family:'ORM Icons'; display:inline-block">&#xa0;</span><span class="orm-Icon-title" style="font-size:12pt">table of contents</span></p><p style="margin-right:30pt; margin-left:30pt; font-size:21pt"><span style="width:6pt; font-family:'ORM Icons'; display:inline-block">&#xa0;</span><span class="orm-Icon-title" style="font-size:12pt">search</span></p><p style="margin-right:30pt; margin-left:30pt; font-size:21pt"><span style="width:6pt; font-family:'ORM Icons'; display:inline-block">&#xa0;</span><span class="orm-Icon-title" style="font-size:12pt">Settings</span></p><p class="playlistsDropdown--FC2Kf" style="margin-right:30pt; margin-left:30pt; line-height:21pt"><span style="width:6pt; font-family:'ORM Icons'; font-size:21pt; display:inline-block">&#xa0;</span><span class="orm-Icon-title" style="font-size:10.5pt; font-weight:bold">queue</span></p><p class="onetrust-pc-sdkot-pc-header" style="margin-left:0.75pt; padding-top:7pt; padding-left:18pt; background-color:#ffffff"><span style="width:17.25pt; display:inline-block">&#xa0;</span><span style="width:36pt; font-size:9pt; font-weight:bold; letter-spacing:0.7pt; display:inline-block">&#xa0;</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkot-pc-title" style="margin:15pt 12.75pt 7.5pt 18.75pt; line-height:16.2pt; background-color:#ffffff"><span style="font-size:13.5pt; font-weight:bold; display:none">Privacy Preference Center</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkot-pc-desc" style="margin-right:12.75pt; margin-left:18.75pt; margin-bottom:18.75pt; line-height:14.65pt; background-color:#ffffff"><span style="font-size:10pt; display:none">When you visit any website, it may store or retrieve information on your browser, mostly in the form of cookies. This information might be about you, your preferences or your device and is mostly used to make the site work as you expect it to. The information does not usually directly identify you, but it can give you a more personalized web experience. Because we respect your right to privacy, you can choose not to allow some types of cookies. Click on the different category headings to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer. </span></p><p class="onetrust-consent-sdkonetrust-pc-sdkprivacy-notice-link" style="margin:3.75pt 12.75pt 18.75pt 18.75pt; line-height:14.65pt; background-color:#ffffff"><a href="https://www.oreilly.com/privacy-cookies.html" target="_blank" style="text-decoration:none"><span style="font-size:10pt; text-decoration:underline; color:#0345ff; display:none">More information</span></a></p><p style="margin-right:43.5pt; margin-left:42pt; margin-bottom:18.75pt; text-align:center; line-height:9pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkbuttonnotclear-filters-handlernotot-close-iconnotfilter-btn-handlernotot-remove-objection-handlernotot-obj-leg-btn-handlernotaria-expandednotot-link-btn" style="border:0.75pt solid #0345ff; font-size:9pt; font-weight:bold; letter-spacing:0.7pt; display:none">Enable All</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkh3" style="margin-right:12.75pt; margin-left:18.75pt; line-height:16.2pt; padding-bottom:7pt; background-color:#ffffff"><span style="font-size:13.5pt; font-weight:bold; display:none">Manage Consent Preferences</span></p><p class="onetrust-pc-sdkot-accordion-layoutot-cat-itemnth-of-type1" style="margin-top:7.5pt; margin-right:12.75pt; margin-left:18.75pt; line-height:13.2pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkh4" style="font-size:10.5pt; font-weight:bold; display:none">Strictly Necessary Cookies</span></p><p class="onetrust-pc-sdkot-accordion-layouth4ot-always-active" style="margin-right:24pt; margin-left:33.75pt; line-height:14.8pt; border:0.75pt solid #d8d8d8; background-color:#ffffff"><span class="onetrust-pc-sdkot-accordion-layoutot-acc-hdr" style="font-size:10.5pt; font-weight:bold; color:#3860be; display:none">Always Active</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkp" style="margin-right:27.75pt; margin-left:33.75pt; line-height:14.65pt; border:0.75pt solid #d8d8d8; background-color:#f8f8f8"><span style="font-size:10pt; display:none">These cookies are necessary for the website to function and cannot be switched off in our systems. They are usually only set in response to actions made by you which amount to a request for services, such as setting your privacy preferences, logging in or filling in forms. You can set your browser to block or alert you about these cookies, but some parts of the site will not then work. These cookies do not store any personally identifiable information.</span></p><p class="onetrust-pc-sdkot-accordion-layoutot-cat-item" style="margin-right:12.75pt; margin-left:18.75pt; line-height:13.2pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkh4" style="font-size:10.5pt; font-weight:bold; display:none">Performance Cookies</span></p><p class="onetrust-pc-sdkot-accordion-layouth4ot-always-active" style="margin-right:24pt; margin-left:33.75pt; line-height:14.8pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#ffffff"><span class="onetrust-pc-sdkot-accordion-layoutot-acc-hdr" style="font-size:10.5pt; font-weight:bold; color:#3860be; display:none">Always Active</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkp" style="margin-right:27.75pt; margin-left:33.75pt; line-height:14.65pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#f8f8f8"><span style="font-size:10pt; display:none">These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site. They help us to know which pages are the most and least popular and see how visitors move around the site. All information these cookies collect is aggregated and therefore anonymous. If you do not allow these cookies we will not know when you have visited our site, and will not be able to monitor its performance.</span></p><p class="onetrust-pc-sdkot-accordion-layoutot-cat-item" style="margin-right:12.75pt; margin-left:18.75pt; line-height:13.2pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkh4" style="font-size:10.5pt; font-weight:bold; display:none">Functional Cookies</span></p><p class="onetrust-pc-sdkot-accordion-layouth4ot-always-active" style="margin-right:24pt; margin-left:33.75pt; line-height:14.8pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#ffffff"><span class="onetrust-pc-sdkot-accordion-layoutot-acc-hdr" style="font-size:10.5pt; font-weight:bold; color:#3860be; display:none">Always Active</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkp" style="margin-right:27.75pt; margin-left:33.75pt; line-height:14.65pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#f8f8f8"><span style="font-size:10pt; display:none">These cookies enable the website to provide enhanced functionality and personalisation. They may be set by us or by third party providers whose services we have added to our pages. If you do not allow these cookies then some or all of these services may not function properly.</span></p><p class="onetrust-pc-sdkot-accordion-layoutot-cat-item" style="margin-right:12.75pt; margin-left:18.75pt; line-height:13.2pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkh4" style="font-size:10.5pt; font-weight:bold; display:none">Targeting Cookies</span></p><p class="onetrust-pc-sdkot-accordion-layouth4ot-always-active" style="margin-right:24pt; margin-left:33.75pt; line-height:14.8pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#ffffff"><span class="onetrust-pc-sdkot-accordion-layoutot-acc-hdr" style="font-size:10.5pt; font-weight:bold; color:#3860be; display:none">Always Active</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkp" style="margin-right:27.75pt; margin-left:33.75pt; line-height:14.65pt; border-right:0.75pt solid #d8d8d8; border-left:0.75pt solid #d8d8d8; border-bottom:0.75pt solid #d8d8d8; background-color:#f8f8f8"><span style="font-size:10pt; display:none">These cookies may be set through our site by our advertising partners. They may be used by those companies to build a profile of your interests and show you relevant adverts on other sites. They do not store directly personal information, but are based on uniquely identifying your browser and internet device. If you do not allow these cookies, you will experience less targeted advertising.</span></p><p class="onetrust-pc-sdkot-lst-title" style="margin-top:11.25pt; margin-right:12.75pt; margin-left:20.25pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkot-pc-lstot-lst-titlespan" style="display:none">Back</span></p><p style="margin-right:12pt; margin-left:19.5pt; background-color:#ffffff"><span class="onetrust-pc-sdkot-lst-subhdr" style="font-weight:bold; display:none">Vendor Search</span></p><p class="onetrust-consent-sdkonetrust-pc-sdkot-fltr-cnt" style="margin-right:13.25pt; margin-left:20.25pt; padding-right:7pt; padding-bottom:3pt; font-size:11pt"><span class="onetrust-consent-sdkonetrust-pc-sdkclear-filters-handler" style="font-weight:bold; display:none">Clear</span></p><p class="onetrust-pc-sdkot-chkbox" style="margin-right:20.25pt; margin-left:31.5pt; margin-bottom:15pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkot-chkboxlabelspan" style="font-size:10pt; display:none">checkbox label</span><span class="onetrust-pc-sdkot-fltr-modal"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkot-label-status" style="font-size:9pt; display:none">label</span></p><p class="onetrust-pc-sdkot-fltr-btns" style="margin-right:20.25pt; margin-left:31.5pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkbuttonnotclear-filters-handlernotot-close-iconnotfilter-btn-handlernotot-remove-objection-handlernotot-obj-leg-btn-handlernotaria-expandednotot-link-btn" style="border:0.75pt solid #0345ff; font-size:9pt; font-weight:bold; letter-spacing:0.7pt; display:none">Apply</span><span class="onetrust-pc-sdkot-fltr-modal"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkbuttonnotclear-filters-handlernotot-close-iconnotfilter-btn-handlernotot-remove-objection-handlernotot-obj-leg-btn-handlernotaria-expandednotot-link-btn" style="border:0.75pt solid #0345ff; font-size:9pt; font-weight:bold; letter-spacing:0.7pt; display:none">Cancel</span></p><p class="onetrust-pc-sdkot-sel-all" style="margin-top:7.5pt; margin-right:8.25pt; margin-left:20.25pt; padding-right:9pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkot-sel-all-hdrspan" style="font-size:10pt; display:none">Consent</span><span class="onetrust-pc-sdkot-sel-all-hdr" style="display:none"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkot-sel-all-hdrspan" style="font-size:10pt; display:none">Leg.Interest</span></p><p class="onetrust-pc-sdkot-sel-blkot-chkbox" style="margin-right:17.25pt; margin-left:20.25pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkot-chkboxlabelspan" style="display:none">checkbox label</span><span class="onetrust-pc-sdkot-sel-all-chkbox" style="display:none"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkot-label-status" style="font-size:9pt; display:none">label</span></p><p class="onetrust-pc-sdkot-sel-blkot-chkbox" style="margin-right:17.25pt; margin-left:20.25pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkot-chkboxlabelspan" style="display:none">checkbox label</span><span class="onetrust-pc-sdkot-sel-all-chkbox" style="display:none"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkot-label-status" style="font-size:9pt; display:none">label</span></p><p class="onetrust-pc-sdkot-sel-blkot-chkbox" style="margin-right:17.25pt; margin-left:20.25pt; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkot-chkboxlabelspan" style="display:none">checkbox label</span><span class="onetrust-pc-sdkot-sel-all-chkbox" style="display:none"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkot-label-status" style="font-size:9pt; display:none">label</span></p><p class="onetrust-pc-sdkot-btn-container" style="margin-right:18.75pt; margin-left:18.75pt; border-top:0.75pt solid #d8d8d8; background-color:#ffffff"><span class="onetrust-consent-sdkonetrust-pc-sdkbuttonnotclear-filters-handlernotot-close-iconnotfilter-btn-handlernotot-remove-objection-handlernotot-obj-leg-btn-handlernotaria-expandednotot-link-btn" style="border:0.75pt solid #0345ff; font-size:9pt; font-weight:bold; letter-spacing:0.7pt; display:none">Reject All</span><span style="display:none"> </span><span class="onetrust-consent-sdkonetrust-pc-sdkbuttonnotclear-filters-handlernotot-close-iconnotfilter-btn-handlernotot-remove-objection-handlernotot-obj-leg-btn-handlernotaria-expandednotot-link-btn" style="border:0.75pt solid #0345ff; font-size:9pt; font-weight:bold; letter-spacing:0.7pt; display:none">Confirm</span></p><p class="onetrust-pc-sdkot-pc-footer-logo" style="margin-left:0.75pt; border-top:0.75pt solid #d8d8d8; padding-left:18pt"><a href="https://www.onetrust.com/products/cookie-consent/" target="_blank" style="text-decoration:none"></a></p><p class="css-1t01ifk" style="padding-right:18pt; padding-left:18pt; vertical-align:middle; background-color:#ffffff"><span class="css-mudjgk" style="vertical-align:middle; display:none">Topics</span></p><p class="css-1t01ifk" style="padding-right:18pt; padding-left:18pt; vertical-align:middle; background-color:#ffffff"><span class="css-mudjgk" style="vertical-align:middle; display:none">Start Learning</span></p><p class="css-1t01ifk" style="padding-right:18pt; padding-left:18pt; vertical-align:middle; background-color:#ffffff"><span class="css-mudjgk" style="vertical-align:middle; display:none">What's New</span></p><p class="css-1kokv6u" style="font-size:1pt"><span style="color:#302f2a; display:none; -aw-import:ignore">&#xa0;</span></p><p style="background-color:#ffffff"><a href="https://learning.oreilly.com/profile/" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Profile</span></a><a href="https://learning.oreilly.com/playlists/" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Playlists</span></a><a href="https://www.oreilly.com/online-learning/support/news.html" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Platform news</span></a></p><p class="css-1kokv6u" style="font-size:1pt"><span style="color:#302f2a; display:none; -aw-import:ignore">&#xa0;</span></p><p style="background-color:#ffffff"><a href="https://learning.oreilly.com/" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Home</span></a><a href="https://learning.oreilly.com/preferences/" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Settings</span></a><a href="https://www.oreilly.com/online-learning/support/" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Support</span></a><a href="https://learning.oreilly.com/member/logout/" style="text-decoration:none"><span class="css-16u51uz" style="background-color:transparent; display:none">Sign out</span></a></p></div></body></html>